<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>跳表-原理篇 | Crayonの博客</title><meta name="author" content="魚禾"><meta name="copyright" content="魚禾"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="article">
<meta property="og:title" content="跳表-原理篇">
<meta property="og:url" content="http://sucrayon.top/posts/2e152a56/index.html">
<meta property="og:site_name" content="Crayonの博客">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://sucrayon.top/images/cover/data-structure/skip-list/%E8%B7%B3%E8%A1%A8-%E5%8E%9F%E7%90%86%E7%AF%87.jpg">
<meta property="article:published_time" content="2025-01-23T15:41:15.000Z">
<meta property="article:modified_time" content="2025-01-23T15:41:15.000Z">
<meta property="article:author" content="魚禾">
<meta property="article:tag" content="数据结构">
<meta property="article:tag" content="跳表">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://sucrayon.top/images/cover/data-structure/skip-list/%E8%B7%B3%E8%A1%A8-%E5%8E%9F%E7%90%86%E7%AF%87.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "跳表-原理篇",
  "url": "http://sucrayon.top/posts/2e152a56/",
  "image": "http://sucrayon.top/images/cover/data-structure/skip-list/%E8%B7%B3%E8%A1%A8-%E5%8E%9F%E7%90%86%E7%AF%87.jpg",
  "datePublished": "2025-01-23T15:41:15.000Z",
  "dateModified": "2025-01-23T15:41:15.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "魚禾",
      "url": "http://sucrayon.top/"
    }
  ]
}</script><link rel="shortcut icon" href="/images/avatar.jpg"><link rel="canonical" href="http://sucrayon.top/posts/2e152a56/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-8421850827711566',
  enable_page_level_ads: 'true'
});</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: 魚禾","link":"链接: ","source":"来源: Crayonの博客","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: false,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '跳表-原理篇',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/static/css/common.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "/images/loading.gif" data-lazy-src="/images/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">32</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/projects/"><i class="fa-fw fas fa-code"></i><span> 项目</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/novel/"><i class="fa-fw fas fa-book-open"></i><span> 小说</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 外链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/images/cover/data-structure/skip-list/跳表-原理篇.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Crayonの博客</span></a><a class="nav-page-title" href="/"><span class="site-name">跳表-原理篇</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/projects/"><i class="fa-fw fas fa-code"></i><span> 项目</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/novel/"><i class="fa-fw fas fa-book-open"></i><span> 小说</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 外链</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">跳表-原理篇</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-01-23T15:41:15.000Z" title="发表于 2025-01-23 23:41:15">2025-01-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-01-23T15:41:15.000Z" title="更新于 2025-01-23 23:41:15">2025-01-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E8%B7%B3%E8%A1%A8/">跳表</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">2.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>9分钟</span></span><span class="post-meta-separator">|</span><span class="leancloud_visitors" id="/posts/2e152a56/" data-flag-title="跳表-原理篇"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span class="leancloud-visitors-count"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/posts/2e152a56/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/posts/2e152a56/" itemprop="commentCount"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><html><head></head><body><h2 id="什么是跳表"><a href="#什么是跳表" class="headerlink" title="什么是跳表"></a>什么是跳表</h2><p>跳表（也可以叫跳跃表，英文名：<em>Skip List</em>）是由<em>William Pugh</em>发明的一种查找数据结构，支持对数据的快速查找、插入和删除</p>
<p>OI Wiki：<a target="_blank" rel="noopener" href="https://oi-wiki.org/ds/skiplist/">跳表 - OI Wiki</a></p>
<p>论文地址：<a target="_blank" rel="noopener" href="https://15721.courses.cs.cmu.edu/spring2018/papers/08-oltpindexes1/pugh-skiplists-cacm1990.pdf">skiplists</a></p>
<p>论文开篇就说明了这是一种可以用来代替平衡树的数据结构（平衡树的实现实在是太复杂了😩）</p>
<p>与平衡树相比，跳表的插入和删除算法要简单得多</p>
<h3 id="BST存在的问题"><a href="#BST存在的问题" class="headerlink" title="BST存在的问题"></a>BST存在的问题</h3><blockquote>
<p>  Binary trees can be used for representing abstract data types such as dictionaries and ordered lists. They work well when the elements are inserted in a random order. Some sequences of operations, such as inserting the elements in order, produce degenerate data structures that give very poor performance. If it were possible to randomly permute the list of items to be in serted, trees would work well with high probability for any in put sequence. In most cases queries must be answered on-line, so randomly permuting the input is impractical. Balanced tree algorithms re-arrange the tree as operations are performed to maintain certain balance conditions and assure good perfor mance.</p>
</blockquote>
<p>论文中提到，对于二叉搜索树而言，当插入的数据是顺序的时候，会产生退化</p>
<p>二叉搜索树（<code>BST</code>，<em>Binary Search Tree</em>），是一种具有特殊排序性质的二叉树，通过在插入数据时保证顺序以便后续能快速检索</p>
<p>理想情况下<code>BST</code>呈现类似以下的结构，能够达到类似二分查找的效果</p>
<pre><code class="highlight mermaid">graph TD;
    A[7] --&gt; B[3];
    A --&gt; C[9];
    B --&gt; D[1];
    B --&gt; E[5];
    E --&gt; F[4];
    E --&gt; G[6];
    C --&gt; H[8];
    C --&gt; I[10];</code></pre>

<p>但是当插入的数据序列就是有序的时候，可能会出现退化成链表的情况</p>
<pre><code class="highlight mermaid">graph TD;
    A[2] --&gt; B[1];
    A --&gt; C[3];
    C --&gt; D[4];
    D --&gt; E[5];
    E --&gt; F[6];</code></pre>

<p><a target="_blank" rel="noopener" href="https://gallery.selfboot.cn/zh/algorithms/binarysearchtree">二叉搜索树可视化</a></p>
<p>关于退化的问题也可以看看小灰的漫画讲解</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzIxMjE5MTE1Nw==&amp;mid=2653190879&amp;idx=1&amp;sn=1916d0f6e72f34408261d70d13eecf5b&amp;chksm=8c990805bbee81137dd6cadbe7b69cf84020233385cc5d7cee778d10977b6f9b28ea235b93e0&amp;scene=21#wechat_redirect">漫画：什么是跳跃表？</a></p>
<h2 id="跳表的结构"><a href="#跳表的结构" class="headerlink" title="跳表的结构"></a>跳表的结构</h2><p>针对<code>BST</code>会退化成链表的问题，或者说针对链表我们想要提高查询效率，使用二分查找的思想我们可以建立多级索引的概念</p>
<p><img src= "/images/loading.gif" data-lazy-src="/posts/2e152a56/1737649458888.png" alt="1737649458888"></p>
<p>原论文中就有提到像<code>AVL</code>等强制平衡（结构定义比较复杂，每次操作都要保证结构的正确性），导致可能最终的性能很好，但是代码的实现难度可能直接导致其他人无法维护和扩展</p>
<p>论文原文是这么描述的：</p>
<blockquote>
<p>Second, if the algorithm is complex, programmers are de terred from implementing optimizations. For example, bal anced tree algorithms are normally described using recursive insert and delete procedures, since that is the most simple and intuitive method of describing the algorithms. A recursive in sert or delete procedure incurs a procedure call overhead. By using non-recursive insert and delete procedures, some of this overhead can be eliminated. However, the complexity of non recursive algorithms for insertion and deletion in a balanced tree is intimidating and this complexity deters most program mers from eliminating recursion in these routines.</p>
<p>  …</p>
<p>From a theoretical point of view, there is no need for skip lists. Balanced trees can do everything that can be done with skip lists and have good worst-case time bounds (unlike skip lists). However, implementing balanced trees is an exacting task and as a result balanced tree algorithms are rarely imple mented except as part of a programming assignment in a data structures class. Skip lists are a simple data structure that can be used in place of balanced trees for most applications. Skip lists algo rithms are very easy to implement, extend and modify. Skip lists are about as fast as highly optimized balanced tree algo rithms and are substantially faster than casually implemented balanced tree algorithms.</p>
</blockquote>
<p>跳表设计上的一个巧妙的点就在于不强制维护索引层级（就是这个设计既兼顾了性能也简化了代码实现）</p>
<p>插入节点的时候随机生成索引层级数</p>
<h3 id="Initialization（初始化）"><a href="#Initialization（初始化）" class="headerlink" title="Initialization（初始化）"></a>Initialization（初始化）</h3><blockquote>
<p>  An element NIL is allocated and given a key greater than any legal key. All levels of all skip lists are terminated with NIL. A new list is initialized so that the the level of the list is equal to 1 and all forward pointers of the list’s header point to NIL.</p>
</blockquote>
<p><img src= "/images/loading.gif" data-lazy-src="/posts/2e152a56/1737706482282.png" alt="1737706482282"></p>
<p>分配一个<code>NIL</code>节点（这个节点的键大于任何元素），所有的节点的所有级别的指针最终都以<code>NIL</code>为终点</p>
<h3 id="Search（查找）"><a href="#Search（查找）" class="headerlink" title="Search（查找）"></a>Search（查找）</h3><p>通过遍历前进指针来搜索元素</p>
<div class="note warning flat"><p>注意：遍历时不会越过正在搜索的元素的节点，当当前层级无法找到指定元素时，需要向下一层级搜索</p>
</div>

<h4 id="算法伪代码"><a href="#算法伪代码" class="headerlink" title="算法伪代码"></a>算法伪代码</h4><p><img src= "/images/loading.gif" data-lazy-src="/posts/2e152a56/1737706994096.png" alt="1737706994096"></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">for i := list-&gt;level downto 1 do</span><br><span class="line">	// 第一层循环，从上到下的层级遍历</span><br><span class="line">	while x-&gt;forward[i]-&gt;key &lt; searchKey do</span><br><span class="line">		// 第二层循环，从左到右遍历，只有节点小于searchKey才能前进（因为是从上到下遍历，节点小于说明searchKey对应的节点一定在该节点 之后，所以可以前进）</span><br><span class="line">		x := x-&gt;forward[i]</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h4 id="逐步解析"><a href="#逐步解析" class="headerlink" title="逐步解析"></a>逐步解析</h4><p>以搜索12节点为例子</p>
<p><img src= "/images/loading.gif" data-lazy-src="/posts/2e152a56/1737708513748.png" alt="1737708513748"></p>
<div class="note info flat"><p><strong>符号说明</strong><br><code>NIL</code>：终点（表示无穷大，搜索到这个节点表示必须向下搜索，即本层遍历结束）<br><code>HEAD</code>：头节点<br><code>x</code>：当前节点<br><code>x.forward[i]</code>：表示x的第i+1层的下一个节点（i+1层的前进指针）<br><code>x.forward[i].key</code>：表示x的第i+1层的下一个节点的key</p>
</div>

<ol start="0">
<li><p>初始化<code>x=HEAD</code></p>
</li>
<li><p><code>x.forward[3].key</code>（也就是节点【6】），6小于12，<code>x = x.forward[3]</code>（前进）</p>
</li>
<li><p><code>x.forward[3].key</code>（也就是节点【<code>NIL</code>】），<code>NIL</code>表示终点（无穷大），<code>i--</code>（向下搜索）</p>
</li>
<li><p><code>x.forward[2].key</code>（也就是节点【25】），25大于12，<code>i--</code>（向下搜索）</p>
</li>
<li><p><code>x.forward[1].key</code>（也就是节点【9】），9小于12，<code>x = x.forward[1]</code>（前进）</p>
</li>
<li><p><code>x.forward[1].key</code>（也就是节点【25】），25大于12，<code>i--</code>（向下搜索）</p>
</li>
<li><p><code>x.forward[0].key</code>（也就是节点【12】），12等于12，<code>i--</code>（向下搜索）</p>
</li>
<li><p><code>i&lt;0</code>表示没有在下一层了，遍历（循环）结束，<code>x</code>停留在节点【12】的前一个节点（也就是节点【9】）</p>
</li>
<li><p><code>x.forward[0].key</code>是否等于12，如果是则说明找到目标，不是则表示目标不在跳表内</p>
</li>
</ol>
<p>可以看到，整个遍历的过程是一个找前驱节点的过程，找到等于目标值的节点的前一个节点</p>
<h3 id="随机函数（Random-Level）"><a href="#随机函数（Random-Level）" class="headerlink" title="随机函数（Random Level）"></a>随机函数（Random Level）</h3><p>跳表使用随机的方式来生成新节点的层高</p>
<p><img src= "/images/loading.gif" data-lazy-src="/posts/2e152a56/1737712483120.png" alt="1737712483120"></p>
<h3 id="Insertion（插入）"><a href="#Insertion（插入）" class="headerlink" title="Insertion（插入）"></a>Insertion（插入）</h3><p>理解了搜索的过程，插入操作也很好理解，本质就是找到前一个节点并将值插入的过程（不熟悉的建议复习下链表的插入操作😁）</p>
<h4 id="算法伪代码-1"><a href="#算法伪代码-1" class="headerlink" title="算法伪代码"></a>算法伪代码</h4><p>先上论文的伪代码</p>
<p><img src= "/images/loading.gif" data-lazy-src="/posts/2e152a56/1737709368360.png" alt="1737709368360"></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Insert(list, searchKey, newValue)</span><br><span class="line">	local update[1...MaxLevel]</span><br><span class="line">	x := list-&gt;header</span><br><span class="line">	// 这一步和搜索的代码一样，找到前驱节点</span><br><span class="line">	for i := list-&gt;level downto 1 do</span><br><span class="line">		while x-&gt;forward[i].key &lt; searchKey do</span><br><span class="line">			x := x-&gt;forward[i]</span><br><span class="line">		-- x-&gt;key &lt; searchKey &lt;= x-&gt;forward[i]-&gt;key</span><br><span class="line">		// 记录了遍历路径中每层的最后一个节点</span><br><span class="line">		update[i] := x</span><br><span class="line">	x := x-&gt;forward[i]</span><br><span class="line">	// 如果相同则直接更新值</span><br><span class="line">	if x-&gt;key = searchKey then x-&gt;value := newValue</span><br><span class="line">	else</span><br><span class="line">		// 随机生成新节点的层级</span><br><span class="line">		|v| := randomLevel()</span><br><span class="line">		// 如果新节点的层级大于当前跳表的最高层级</span><br><span class="line">		// 记录相应的信息方便后面统一更新节点</span><br><span class="line">		// 还要更新当前跳表的最高层级</span><br><span class="line">		if |v| &gt; list-&gt;level then</span><br><span class="line">			for i := list-&gt;level+1 to |v| do</span><br><span class="line">				update[i] := list-&gt;header</span><br><span class="line">			list-&gt;level := |v|</span><br><span class="line">		x := makeNode(|v|, searchKey, value)</span><br><span class="line">		// 和常规的链表插入操作类似</span><br><span class="line">		// 1. 新节点连接前驱节点的下一个节点</span><br><span class="line">		// 2. 前驱节点在连接新节点</span><br><span class="line">		for i := 1 to level do</span><br><span class="line">			x-&gt;forward[i] := update[i]-&gt;forward[i]</span><br><span class="line">			update[i]-&gt;forward[i] := x</span><br></pre></td></tr></tbody></table></figure>

<h4 id="逐步解析-1"><a href="#逐步解析-1" class="headerlink" title="逐步解析"></a>逐步解析</h4><p>以下是论文中关于插入节点【17】的示意图</p>
<p><img src= "/images/loading.gif" data-lazy-src="/posts/2e152a56/1737706980365.png" alt="1737706980365"></p>
<p>对着论文的示意图我们逐步分析代码的执行过程</p>
<div class="note info flat"><p><strong>符号说明</strong><br><code>NIL</code>：终点（表示无穷大，搜索到这个节点表示必须向下搜索，即本层遍历结束）<br><code>HEAD</code>：头节点<br><code>x</code>：当前节点<br><code>x.forward[i]</code>：表示x的第i+1层的下一个节点（i+1层的前进指针）<br><code>x.forward[i].key</code>：表示x的第i+1层的下一个节点的key<br><code>update</code>：update数组，记录了遍历过程中每一层的最后一个节点（从哪个节点往下遍历的，这些节点是需要同步更新的）</p>
</div>



<ol start="0">
<li>初始化<code>x=HEAD</code>，初始化<code>update数组</code>（直接初始化最大的层级数的大小，后续不用动态扩缩）</li>
</ol>
<p>遍历过程中与搜索的一样，只是在向下搜索之前将节点记录到<code>update</code></p>
<h5 id="V-level"><a href="#V-level" class="headerlink" title="|V| <= list->level"></a>|V| &lt;= list-&gt;level</h5><p><strong>新节点层级不超过当前跳表的最高层级</strong></p>
<p>这种情况下我们只需要更新新节点对应的层级上的前驱节点即可</p>
<p><img src= "/images/loading.gif" data-lazy-src="/posts/2e152a56/insert-case1.svg" alt="insert-case1"></p>
<h5 id="V-list-level"><a href="#V-list-level" class="headerlink" title="|V| > list->level"></a>|V| &gt; list-&gt;level</h5><p><strong>新节点层级超过当前跳表的最高层级</strong></p>
<p>遍历过程中由于并不经过<code>HEAD</code>所以<code>update</code>中不会有记录，而当新节点的层级超过当前跳表最高层级的时候又需要更新<code>HEAD</code>的前进指针，为了后续操作逻辑统一，单独执行一遍循环赋值，这就是以下代码的含义</p>
<p><img src= "/images/loading.gif" data-lazy-src="/posts/2e152a56/1737712286704.png" alt="1737712286704"></p>
<p><img src= "/images/loading.gif" data-lazy-src="/posts/2e152a56/insert-case2.svg" alt="insert-case2"></p>
<h3 id="Deletion（删除）"><a href="#Deletion（删除）" class="headerlink" title="Deletion（删除）"></a>Deletion（删除）</h3><h4 id="算法伪代码-2"><a href="#算法伪代码-2" class="headerlink" title="算法伪代码"></a>算法伪代码</h4><p><img src= "/images/loading.gif" data-lazy-src="/posts/2e152a56/1737712378629.png" alt="1737712378629"></p>
<h4 id="逐步解析-2"><a href="#逐步解析-2" class="headerlink" title="逐步解析"></a>逐步解析</h4><p>跳表节点的删除也非常的简单，和链表的删除操作相同，只是多了多层级节点的更新的操作</p>
<ol>
<li><p>搜索前驱节点</p>
</li>
<li><p>更新所有相关层级（<code>update</code>）的指针（断开与被删除节点的连接）</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">for i := 1 to list-&gt;level do</span><br><span class="line">	// 判断是否需要更新，如果前一个节点连接的不是被删除节点，那就不需要更新，可以提前中止循环</span><br><span class="line">	if update[i]-&gt;forward[i] != x then break</span><br><span class="line">	update[i]-&gt;forward[i] := x-&gt;forward[i]</span><br><span class="line">// 显式释放</span><br><span class="line">free(x)</span><br><span class="line">...</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>从上到下更新<code>HEAD</code>指针，跳表层级更新</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">// 通过另一个循环来更新当前跳表的最高层级</span><br><span class="line">// 职责单一（一个循环更新节点指针，一个循环更新层级数），代码可读性更好</span><br><span class="line">while list-&gt;level &gt; 1 and</span><br><span class="line">	list-&gt;header-&gt;forward[list-&gt;level] = NIL do</span><br><span class="line">	list-&gt;level := list-&gt;level-1</span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><blockquote>
<p>  <a target="_blank" rel="noopener" href="https://gallery.selfboot.cn/zh/algorithms/skiplist">跳表可视化：https://gallery.selfboot.cn/zh/algorithms/skiplist</a></p>
<p>  <a target="_blank" rel="noopener" href="https://15721.courses.cs.cmu.edu/spring2018/papers/08-oltpindexes1/pugh-skiplists-cacm1990.pdf">跳表论文：https://15721.courses.cs.cmu.edu/spring2018/papers/08-oltpindexes1/pugh-skiplists-cacm1990.pdf</a></p>
<p>  <a target="_blank" rel="noopener" href="https://oi-wiki.org/ds/skiplist/">跳表 - OI Wiki</a></p>
<p>  <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzIxMjE5MTE1Nw==&amp;mid=2653190879&amp;idx=1&amp;sn=1916d0f6e72f34408261d70d13eecf5b&amp;chksm=8c990805bbee81137dd6cadbe7b69cf84020233385cc5d7cee778d10977b6f9b28ea235b93e0&amp;scene=21#wechat_redirect">漫画：什么是跳跃表？</a></p>
</blockquote>
</body></html></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://sucrayon.top">魚禾</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://sucrayon.top/posts/2e152a56/">http://sucrayon.top/posts/2e152a56/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://sucrayon.top" target="_blank">Crayonの博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a><a class="post-meta__tags" href="/tags/%E8%B7%B3%E8%A1%A8/">跳表</a></div><div class="post-share"><div class="social-share" data-image="/images/cover/data-structure/skip-list/%E8%B7%B3%E8%A1%A8-%E5%8E%9F%E7%90%86%E7%AF%87.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/images/wxpay.png" target="_blank"><img class="post-qr-code-img" src= "/images/loading.gif" data-lazy-src="/images/wxpay.png" alt="wxpay"/></a><div class="post-qr-code-desc">wxpay</div></li><li class="reward-item"><a href="/images/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "/images/loading.gif" data-lazy-src="/images/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/eca128ac/" title="Redis-字典"><img class="cover" src= "/images/loading.gif" data-lazy-src="/images/cover/nosql/redis/%E5%AD%97%E5%85%B8.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Redis-字典</div></div><div class="info-2"><div class="info-item-1">Redis中的字典被广泛用于实现Redis的各种功能，其中包括数据库和哈希键。字典会根据负载情况自动进行扩容和收缩，而和其他语言哈希表的扩缩容不同的是，Redis采用渐进式操作的方式实现，以保证扩缩容期间服务的性能稳定</div></div></div></a><a class="pagination-related" href="/posts/b1617a14/" title="跳表-实现篇（Golang）"><img class="cover" src= "/images/loading.gif" data-lazy-src="/images/cover/data-structure/skip-list/%E8%B7%B3%E8%A1%A8-%E5%AE%9E%E7%8E%B0%E7%AF%87%EF%BC%88Golang%EF%BC%89.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">跳表-实现篇（Golang）</div></div><div class="info-2"><div class="info-item-1">简介本文将参照论文使用Golang语言实现跳表 建议阅读：跳表-原理篇 | Crayonの博客 本文按照以下顺序进行：  简介 编码实现 结构体定义 随机函数 查找 插入 删除   代码测试 性能对比 数据量1k 数据量1w 数据量10w     Leetcode  编码实现本次实现和论文一样，节点顺序以升序排序 结构体定义12345678910111213141516type (	Node struct {		Key      float64		Value    interface{}		Forwards []*Node	}	SkipList struct {		Head     *Node		Level    int		// MaxLevel 跳表的最大层级，这样可以很方便的实现不同最高层级的跳表		MaxLevel int		// P 层级上升的概率		P        float64	})  随机函数和论文如出一辙，这里使用了golang的rand包来生成随机数 1234567func (s *SkipList) randomLevel() int {	level :=...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/a381e6f7/" title="跳表-实现篇（Redis）"><img class="cover" src= "/images/loading.gif" data-lazy-src="/images/cover/data-structure/skip-list/%E8%B7%B3%E8%A1%A8-%E5%AE%9E%E7%8E%B0%E7%AF%87%EF%BC%88Redis%EF%BC%89.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2025-02-02</div><div class="info-item-2">跳表-实现篇（Redis）</div></div><div class="info-2"><div class="info-item-1">简介本文基于 Redis3.0 版本的源码解读跳表的实现 Redis3.0 源码链接：[redis/redis at 3.0.0](https://github.com/redis/redis/tree/3.0.0)  建议阅读：  跳表-原理篇 | Crayonの博客  本文按照以下顺序进行：  简介 背景知识 源码解读 结构体定义 随机函数 查找 插入 删除    背景知识Redis 内置了多种数据结构，其中`zset`（有序集合，英文名：sorted set）兼具集合的元素唯一性以及有序性（元素有序性）两个特性，被广泛用在日常业务需求的开发中  zset由多个数据结构组合实现的，而跳表（zskiplist）就是实现有序性的关键数据结构，Redis 就是通过跳表实现了zset结构的排序、根据排名的范围获取等操作 Redis 自己实现了跳表结构，为符合自身业务操作的需要增加了一些额外的字段以及操作，虽然和原始论文中的结构不太一样，但基本的操作逻辑都是相同的  源码解读结构体定义zset1234typedef struct zset {    dict *dict;   ...</div></div></div></a><a class="pagination-related" href="/posts/b1617a14/" title="跳表-实现篇（Golang）"><img class="cover" src= "/images/loading.gif" data-lazy-src="/images/cover/data-structure/skip-list/%E8%B7%B3%E8%A1%A8-%E5%AE%9E%E7%8E%B0%E7%AF%87%EF%BC%88Golang%EF%BC%89.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2025-01-25</div><div class="info-item-2">跳表-实现篇（Golang）</div></div><div class="info-2"><div class="info-item-1">简介本文将参照论文使用Golang语言实现跳表 建议阅读：跳表-原理篇 | Crayonの博客 本文按照以下顺序进行：  简介 编码实现 结构体定义 随机函数 查找 插入 删除   代码测试 性能对比 数据量1k 数据量1w 数据量10w     Leetcode  编码实现本次实现和论文一样，节点顺序以升序排序 结构体定义12345678910111213141516type (	Node struct {		Key      float64		Value    interface{}		Forwards []*Node	}	SkipList struct {		Head     *Node		Level    int		// MaxLevel 跳表的最大层级，这样可以很方便的实现不同最高层级的跳表		MaxLevel int		// P 层级上升的概率		P        float64	})  随机函数和论文如出一辙，这里使用了golang的rand包来生成随机数 1234567func (s *SkipList) randomLevel() int {	level :=...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "/images/loading.gif" data-lazy-src="/images/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">魚禾</div><div class="author-info-description">Crayon</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">32</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/SuCrayon"><i class="fab fa-github"></i><span>Github</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/SuCrayon" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:614820984@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%B7%B3%E8%A1%A8"><span class="toc-text">什么是跳表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BST%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">BST存在的问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%B3%E8%A1%A8%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-text">跳表的结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Initialization%EF%BC%88%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%89"><span class="toc-text">Initialization（初始化）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Search%EF%BC%88%E6%9F%A5%E6%89%BE%EF%BC%89"><span class="toc-text">Search（查找）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E4%BC%AA%E4%BB%A3%E7%A0%81"><span class="toc-text">算法伪代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%90%E6%AD%A5%E8%A7%A3%E6%9E%90"><span class="toc-text">逐步解析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E5%87%BD%E6%95%B0%EF%BC%88Random-Level%EF%BC%89"><span class="toc-text">随机函数（Random Level）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Insertion%EF%BC%88%E6%8F%92%E5%85%A5%EF%BC%89"><span class="toc-text">Insertion（插入）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E4%BC%AA%E4%BB%A3%E7%A0%81-1"><span class="toc-text">算法伪代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%90%E6%AD%A5%E8%A7%A3%E6%9E%90-1"><span class="toc-text">逐步解析</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#V-level"><span class="toc-text">|V| &lt;&#x3D; list-&gt;level</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#V-list-level"><span class="toc-text">|V| &gt; list-&gt;level</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Deletion%EF%BC%88%E5%88%A0%E9%99%A4%EF%BC%89"><span class="toc-text">Deletion（删除）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E4%BC%AA%E4%BB%A3%E7%A0%81-2"><span class="toc-text">算法伪代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%90%E6%AD%A5%E8%A7%A3%E6%9E%90-2"><span class="toc-text">逐步解析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-text">参考资料</span></a></li></ol></div></div><div class="card-widget card-post-series"><div class="item-headline"><i class="fa-solid fa-layer-group"></i><span>系列文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/2e152a56/" title="跳表-原理篇"><img src= "/images/loading.gif" data-lazy-src="/images/cover/data-structure/skip-list/%E8%B7%B3%E8%A1%A8-%E5%8E%9F%E7%90%86%E7%AF%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="跳表-原理篇"></a><div class="content"><a class="title" href="/posts/2e152a56/" title="跳表-原理篇">跳表-原理篇</a><time datetime="2025-01-23T15:41:15.000Z" title="发表于 2025-01-23 23:41:15">2025-01-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/b1617a14/" title="跳表-实现篇（Golang）"><img src= "/images/loading.gif" data-lazy-src="/images/cover/data-structure/skip-list/%E8%B7%B3%E8%A1%A8-%E5%AE%9E%E7%8E%B0%E7%AF%87%EF%BC%88Golang%EF%BC%89.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="跳表-实现篇（Golang）"></a><div class="content"><a class="title" href="/posts/b1617a14/" title="跳表-实现篇（Golang）">跳表-实现篇（Golang）</a><time datetime="2025-01-25T08:06:00.000Z" title="发表于 2025-01-25 16:06:00">2025-01-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a381e6f7/" title="跳表-实现篇（Redis）"><img src= "/images/loading.gif" data-lazy-src="/images/cover/data-structure/skip-list/%E8%B7%B3%E8%A1%A8-%E5%AE%9E%E7%8E%B0%E7%AF%87%EF%BC%88Redis%EF%BC%89.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="跳表-实现篇（Redis）"></a><div class="content"><a class="title" href="/posts/a381e6f7/" title="跳表-实现篇（Redis）">跳表-实现篇（Redis）</a><time datetime="2025-01-28T06:20:00.000Z" title="发表于 2025-01-28 14:20:00">2025-01-28</time></div></div></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/e3e1c4a3/" title="LC-77-组合"><img src= "/images/loading.gif" data-lazy-src="/images/cover/algorithm/LC-77-%E7%BB%84%E5%90%88.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LC-77-组合"/></a><div class="content"><a class="title" href="/posts/e3e1c4a3/" title="LC-77-组合">LC-77-组合</a><time datetime="2025-02-03T08:58:00.000Z" title="更新于 2025-02-03 16:58:00">2025-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a381e6f7/" title="跳表-实现篇（Redis）"><img src= "/images/loading.gif" data-lazy-src="/images/cover/data-structure/skip-list/%E8%B7%B3%E8%A1%A8-%E5%AE%9E%E7%8E%B0%E7%AF%87%EF%BC%88Redis%EF%BC%89.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="跳表-实现篇（Redis）"/></a><div class="content"><a class="title" href="/posts/a381e6f7/" title="跳表-实现篇（Redis）">跳表-实现篇（Redis）</a><time datetime="2025-02-02T09:47:21.000Z" title="更新于 2025-02-02 17:47:21">2025-02-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/b1617a14/" title="跳表-实现篇（Golang）"><img src= "/images/loading.gif" data-lazy-src="/images/cover/data-structure/skip-list/%E8%B7%B3%E8%A1%A8-%E5%AE%9E%E7%8E%B0%E7%AF%87%EF%BC%88Golang%EF%BC%89.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="跳表-实现篇（Golang）"/></a><div class="content"><a class="title" href="/posts/b1617a14/" title="跳表-实现篇（Golang）">跳表-实现篇（Golang）</a><time datetime="2025-01-25T08:06:00.000Z" title="更新于 2025-01-25 16:06:00">2025-01-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2e152a56/" title="跳表-原理篇"><img src= "/images/loading.gif" data-lazy-src="/images/cover/data-structure/skip-list/%E8%B7%B3%E8%A1%A8-%E5%8E%9F%E7%90%86%E7%AF%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="跳表-原理篇"/></a><div class="content"><a class="title" href="/posts/2e152a56/" title="跳表-原理篇">跳表-原理篇</a><time datetime="2025-01-23T15:41:15.000Z" title="更新于 2025-01-23 23:41:15">2025-01-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a8e92d53/" title="Golang-数组与切片"><img src= "/images/loading.gif" data-lazy-src="/images/cover/programming-language/golang/%E6%95%B0%E7%BB%84%E4%B8%8E%E5%88%87%E7%89%87.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Golang-数组与切片"/></a><div class="content"><a class="title" href="/posts/a8e92d53/" title="Golang-数组与切片">Golang-数组与切片</a><time datetime="2024-12-20T15:37:29.000Z" title="更新于 2024-12-20 23:37:29">2024-12-20</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/images/cover/data-structure/skip-list/跳表-原理篇.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2025 By 魚禾</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><div style="width:300px;margin:0 auto; padding:20px 0;"><div style="display: flex;align-items: center;justify-content: center;"><img src= "/images/loading.gif" data-lazy-src="/images/police-icon.png" style="margin-right: 4px; width: 20px; height: 20px;" /><div><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">粤ICP备2022062775号-1</a></div></div><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44030902003468" style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#939393;">粤公网安备 44030902003468号</p></a></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://unpkg.com/vanilla-lazyload@17.8.3/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const initValine = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyValine = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const valineConfig = {
      el: '#vcomment',
      appId: 'WkTbxHB8e44QglvhnPIwLU2n-gzGzoHsz',
      appKey: 'eXdRcA3tj4kM837wFGylIyBt',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      visitor: true,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || window.location.pathname
    }

    new Valine(valineConfig)
  }

  const loadValine = async (el, path) => {
    if (typeof Valine === 'function') {
      initValine(el, path)
    } else {
      await btf.getScript('https://unpkg.com/valine@1.5.1/dist/Valine.min.js')
      initValine(el, path)
    }
  }

  if (isShuoshuo) {
    'Valine' === 'Valine'
      ? window.shuoshuoComment = { loadComment: loadValine }
      : window.loadOtherComment = loadValine
    return
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script></div><script defer="defer" id="ribbon" src="https://unpkg.com/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"display":{"position":"left","width":150,"height":300,"hOffset":50},"mobile":{"show":false},"react":{"opacity":0.8},"log":false});</script></body></html>